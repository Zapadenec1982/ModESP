# Core Modules - –û—Å–Ω–æ–≤–Ω—ñ —Å–∏—Å—Ç–µ–º–Ω—ñ –º–æ–¥—É–ª—ñ

–ë–∞–∑–æ–≤—ñ –º–æ–¥—É–ª—ñ —â–æ –∑–∞–±–µ–∑–ø–µ—á—É—é—Ç—å —Ñ—É–Ω–∫—Ü—ñ–æ–Ω—É–≤–∞–Ω–Ω—è –≤—Å—ñ—î—ó —Å–∏—Å—Ç–µ–º–∏ ModESP.

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∏ –≤ —Ü—å–æ–º—É —Ä–æ–∑–¥—ñ–ª—ñ

### –ì–æ–ª–æ–≤–Ω—ñ –º–æ–¥—É–ª—ñ
- **[core_system.md](core_system.md)** - üÜï –ü–æ–≤–Ω–∏–π –¥–æ–≤—ñ–¥–Ω–∏–∫ –ø–æ Core —Å–∏—Å—Ç–µ–º—ñ
  - Application Controller, EventBus, SharedState, Config
  - Memory footprint —Ç–∞ performance —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏
  - API reference –∑ –ø—Ä–∏–∫–ª–∞–¥–∞–º–∏
  - Communication patterns —Ç–∞ best practices

- **[event_bus.md](event_bus.md)** - üÜï EventBus - –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞ —Å–∏—Å—Ç–µ–º–∞ –ø–æ–¥—ñ–π
  - Thread-safe publish-subscribe —Å–∏—Å—Ç–µ–º–∞
  - –ü—Ä—ñ–æ—Ä–∏—Ç–µ—Ç–Ω—ñ—Å—Ç—å —Ç–∞ —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—è –ø–æ–¥—ñ–π
  - Pattern matching –¥–ª—è –ø—ñ–¥–ø–∏—Å–æ–∫
  - –ü—Ä–∏–∫–ª–∞–¥–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —Ç–∞ best practices

- **[shared_state.md](shared_state.md)** - üÜï –¶–µ–Ω—Ç—Ä–∞–ª—ñ–∑–æ–≤–∞–Ω–µ —Å—Ö–æ–≤–∏—â–µ —Å—Ç–∞–Ω—É
  - Key-value storage –∑ type safety
  - Thread-safe –æ–ø–µ—Ä–∞—Ü—ñ—ó
  - –ü—ñ–¥–ø–∏—Å–∫–∞ –Ω–∞ –∑–º—ñ–Ω–∏ (callback system)
  - Naming conventions —Ç–∞ patterns

### ConfigManager —Å–∏—Å—Ç–µ–º–∞
- **[config_manager_overview.md](config_manager_overview.md)** - üÜï ConfigManager overview
  - Modular configuration management
  - RAM caching —Ç–∞ atomic saves
  - Lifecycle management
  - Async optimization features

- **[lifecycle_architecture.md](lifecycle_architecture.md)** - üÜï Lifecycle –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞
  - BOOT ‚Üí RUNTIME ‚Üí SHUTDOWN —Ñ–∞–∑–∏
  - –°–∏–Ω—Ö—Ä–æ–Ω–Ω—ñ vs –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ñ –æ–ø–µ—Ä–∞—Ü—ñ—ó
  - –ü—Ä–∞–≤–∏–ª—å–Ω–∏–π –ø–æ—Ä—è–¥–æ–∫ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è/–∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è

- **[async_optimization.md](async_optimization.md)** - üÜï LittleFS –æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—è
  - Watchdog-friendly –æ–ø–µ—Ä–∞—Ü—ñ—ó
  - –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∏–π –∑–∞–ø–∏—Å —Ç–∞ batching
  - Performance optimization

- **[config_quick_reference.md](config_quick_reference.md)** - üÜï –®–≤–∏–¥–∫–∏–π –¥–æ–≤—ñ–¥–Ω–∏–∫
  - API –º–µ—Ç–æ–¥–∏ —Ç–∞ –ø—Ä–∏–∫–ª–∞–¥–∏
  - Best practices –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó

- **[config_lifecycle_sequence.mmd](config_lifecycle_sequence.mmd)** - üÜï Mermaid –¥—ñ–∞–≥—Ä–∞–º–∏
  - –í—ñ–∑—É–∞–ª—å–Ω—ñ —Å—Ö–µ–º–∏ lifecycle –ø—Ä–æ—Ü–µ—Å—ñ–≤

### –î–æ–ø–æ–º—ñ–∂–Ω—ñ –º–æ–¥—É–ª—ñ
- **[application_lifecycle.txt](application_lifecycle.txt)** - Lifecycle –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä
  - –ö–µ—Ä—É–≤–∞–Ω–Ω—è –∂–∏—Ç—Ç—î–≤–∏–º —Ü–∏–∫–ª–æ–º —Å–∏—Å—Ç–µ–º–∏
  - –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è —Ç–∞ shutdown –ø—Ä–æ—Ü–µ–¥—É—Ä–∏
  - Error handling —Ç–∞ recovery

- **[config_manager.txt](config_manager.txt)** - –°–∏—Å—Ç–µ–º–∞ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó
  - JSON-based –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è
  - NVS persistence
  - Validation —Ç–∞ defaults

- **[module_manager.txt](module_manager.txt)** - –£–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –º–æ–¥—É–ª—è–º–∏
  - Priority-based execution
  - Module registration —Ç–∞ lifecycle
  - Coordination –º—ñ–∂ –º–æ–¥—É–ª—è–º–∏

- **[event_bus_example.cpp](event_bus_example.cpp)** - –ü—Ä–∏–∫–ª–∞–¥ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è EventBus
  - –ü–æ–≤–Ω–∏–π —Ä–æ–±–æ—á–∏–π –ø—Ä–∏–∫–ª–∞–¥
  - –ü—ñ–¥–ø–∏—Å–∫–∞ —Ç–∞ –ø—É–±–ª—ñ–∫–∞—Ü—ñ—è –ø–æ–¥—ñ–π
  - –û–±—Ä–æ–±–∫–∞ –ø—Ä—ñ–æ—Ä–∏—Ç–µ—Ç—ñ–≤

## üéØ –ö–ª—é—á–æ–≤—ñ –∫–æ–Ω—Ü–µ–ø—Ü—ñ—ó

### Core Principles
- **< 5KB RAM footprint** –¥–ª—è –≤—Å—å–æ–≥–æ —è–¥—Ä–∞
- **Zero Dynamic Allocation** - –≤—Å—è –ø–∞–º'—è—Ç—å –Ω–∞ —Å—Ç–∞—Ä—Ç—ñ
- **Explicit Dependencies** - –Ω—ñ—è–∫–∏—Ö hidden singletons
- **Fail-Safe** - —Å–∏—Å—Ç–µ–º–∞ –ø—Ä–∞—Ü—é—î –Ω–∞–≤—ñ—Ç—å –ø—Ä–∏ –∑–±–æ—è—Ö –º–æ–¥—É–ª—ñ–≤

### –ê—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞
```
Application Controller (Main Loop @ 100Hz)
    ‚Üì
ModuleManager (Priority-based execution)
    ‚Üì
Core Services
‚îú‚îÄ‚îÄ SharedState (Data Exchange)
‚îú‚îÄ‚îÄ EventBus (Async Messaging) 
‚îú‚îÄ‚îÄ Config (Persistent Storage)
‚îî‚îÄ‚îÄ Diagnostic (Health Monitoring)
```

## üîÑ –ü–æ—Ç–æ–∫–∏ –¥–∞–Ω–∏—Ö

### SharedState Pattern (–æ—Å–Ω–æ–≤–Ω–∏–π)
```cpp
// Producer
SharedState::set("sensor.temperature", 22.5f);

// Consumer  
auto temp = SharedState::get<float>("sensor.temperature");
if (temp.has_value()) {
    process_temperature(temp.value());
}
```

### EventBus Pattern (–¥–ª—è –ø–æ–¥—ñ–π)
```cpp
// Publisher
EventBus::publish("alarm.high_temp", {{"value", 35.0}});

// Subscriber
EventBus::subscribe("alarm.*", [](const Event& e) {
    handle_alarm(e.type, e.data);
});
```

## üìä Performance —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | Static RAM | –û–ø–µ—Ä–∞—Ü—ñ—ó/—Å | Latency |
|-----------|------------|------------|---------|
| Application | 128-256B | 100Hz loop | 10ms |
| SharedState | 2.5-3.5KB | 10,000+ | <1ms |
| EventBus | 600-800B | 1,000+ | <5ms |
| Config | 256B | 10-100 | 10-50ms |

## üîó –ó–≤'—è–∑–∫–∏ –∑ —ñ–Ω—à–∏–º–∏ –º–æ–¥—É–ª—è–º–∏

- **HAL**: [02_Architecture/hal_reference.md](../../02_Architecture/hal_reference.md)
- **Sensors**: [../sensors/](../sensors/README.md) - –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å SharedState
- **Actuators**: [../actuators/](../actuators/README.md) - –ø—ñ–¥–ø–∏—Å–∞–Ω—ñ –Ω–∞ SharedState
- **UI/API**: [../../05_UI_API/](../../05_UI_API/README.md) - —á–∏—Ç–∞—é—Ç—å –∑ SharedState

## üöÄ –®–≤–∏–¥–∫–∏–π —Å—Ç–∞—Ä—Ç

### –î–ª—è —Ä–æ–∑—É–º—ñ–Ω–Ω—è –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∏ (30 —Ö–≤)
1. **[core_system.md](core_system.md)** - –∑–∞–≥–∞–ª—å–Ω–∏–π –æ–≥–ª—è–¥
2. **[shared_state.md](shared_state.md)** - –æ—Å–Ω–æ–≤–∏ data exchange

### –î–ª—è —Ä–æ–∑—Ä–æ–±–∫–∏ (1-2 –≥–æ–¥)
1. –ü—Ä–æ—á–∏—Ç–∞–π—Ç–µ Core API –∑ [core_system.md](core_system.md)
2. –í–∏–≤—á—ñ—Ç—å patterns –∑ [shared_state.md](shared_state.md)
3. –ü–µ—Ä–µ–π–¥—ñ—Ç—å –¥–æ [../sensors/](../sensors/README.md) –∞–±–æ [../actuators/](../actuators/README.md)

---

*–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è –æ–Ω–æ–≤–ª–µ–Ω–∞: 2025-06-29*
