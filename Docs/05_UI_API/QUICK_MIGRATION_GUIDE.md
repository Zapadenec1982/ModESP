# üöÄ –®–≤–∏–¥–∫–∏–π –ø–ª–∞–Ω –º—ñ–≥—Ä–∞—Ü—ñ—ó –Ω–∞ adaptive_ui

## –©–æ —Ä–æ–±–∏–º–æ
–ü–µ—Ä–µ–Ω–æ—Å–∏–º–æ –≤–µ—Å—å UI –Ω–∞ `adaptive_ui/` —Ç–∞ –≤–∏–¥–∞–ª—è—î–º–æ —Å—Ç–∞—Ä—É `ui/` —Å–∏—Å—Ç–µ–º—É.

## –ß–æ–º—É
- `ui/` - –∑–∞—Å—Ç–∞—Ä—ñ–ª–∞ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—è
- `adaptive_ui/` - —Å—É—á–∞—Å–Ω–∞ –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞ –∑ —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—î—é —Ç–∞ lazy loading
- –ú–µ–Ω—à–µ –∫–æ–¥—É = –ª–µ–≥—à–µ –ø—ñ–¥—Ç—Ä–∏–º—É–≤–∞—Ç–∏

## –ö—Ä–æ–∫–∏ (30 —Ö–≤–∏–ª–∏–Ω)

### 1. –ó–∞–ø—É—Å—Ç–∏—Ç–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω—É –º—ñ–≥—Ä–∞—Ü—ñ—é (2 —Ö–≤)
```bash
cd C:/ModESP_dev
python tools/migrate_to_adaptive_ui.py
```

–°–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ:
- ‚úì –°—Ç–≤–æ—Ä–∏—Ç—å backup
- ‚úì –ü–µ—Ä–µ–Ω–µ—Å–µ –≤–µ–±-—Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª –≤ adaptive_ui
- ‚úì –ê–¥–∞–ø—Ç—É—î –∫–æ–¥ –ø—ñ–¥ –Ω–æ–≤—É –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä—É
- ‚úì –û–Ω–æ–≤–∏—Ç—å CMakeLists.txt

### 2. –û–Ω–æ–≤–∏—Ç–∏ –∑–∞–ª–µ–∂–Ω—ñ—Å—Ç—å –≤ core (5 —Ö–≤)

**–§–∞–π–ª**: `components/core/CMakeLists.txt`

–ó–º—ñ–Ω–∏—Ç–∏:
```cmake
REQUIRES 
    # ... —ñ–Ω—à—ñ
    ui  # <- –≤–∏–¥–∞–ª–∏—Ç–∏
    adaptive_ui  # <- –¥–æ–¥–∞—Ç–∏
```

### 3. –í–∏–ø—Ä–∞–≤–∏—Ç–∏ application.cpp (5 —Ö–≤)

**–§–∞–π–ª**: `components/core/src/application/application.cpp`

a) –í–∏–¥–∞–ª–∏—Ç–∏ –Ω–µ–ø–æ—Ç—Ä—ñ–±–Ω–∏–π include:
```cpp
#include "api_dispatcher.h"  // <- –≤–∏–¥–∞–ª–∏—Ç–∏
```

b) –ó–∞–∫–æ–º–µ–Ω—Ç—É–≤–∞—Ç–∏ –∞–±–æ –≤–∏–¥–∞–ª–∏—Ç–∏ –∫–æ–¥ –∑ ConfigurationManager (—Ä—è–¥–∫–∏ ~107-113):
```cpp
// –í–∏–¥–∞–ª–∏—Ç–∏ –∞–±–æ –∑–∞–∫–æ–º–µ–Ω—Ç—É–≤–∞—Ç–∏ —Ü–µ–π –±–ª–æ–∫:
/*
ret = ConfigurationManager::instance().initialize();
if (ret != ESP_OK) {
    ESP_LOGE(TAG, "Failed to initialize Configuration Manager: %s", esp_err_to_name(ret));
    current_state = State::ERROR;
    return ret;
}
*/
```

### 4. –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –∑–±—ñ—Ä–∫—É (5 —Ö–≤)
```bash
idf.py build
```

### 5. –ü—ñ—Å–ª—è —É—Å–ø—ñ—à–Ω–æ–≥–æ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è - –≤–∏–¥–∞–ª–∏—Ç–∏ ui/ (1 —Ö–≤)
```bash
# –ê—Ä—Ö—ñ–≤—É–≤–∞—Ç–∏ (–Ω–∞ –≤—Å—è–∫ –≤–∏–ø–∞–¥–æ–∫)
mv components/ui components/_archive_ui/old_ui_final

# –ê–ë–û –ø—Ä–æ—Å—Ç–æ –≤–∏–¥–∞–ª–∏—Ç–∏
rm -rf components/ui
```

## üìÅ –©–æ –æ—Ç—Ä–∏–º–∞—î–º–æ

**–ë—É–ª–æ**:
```
components/
‚îú‚îÄ‚îÄ ui/              # –°—Ç–∞—Ä–∞ —Å–∏—Å—Ç–µ–º–∞
‚îî‚îÄ‚îÄ adaptive_ui/     # –ù–æ–≤–∞ —Å–∏—Å—Ç–µ–º–∞
```

**–°—Ç–∞–Ω–µ**:
```
components/
‚îî‚îÄ‚îÄ adaptive_ui/     # –Ñ–¥–∏–Ω–∞ UI —Å–∏—Å—Ç–µ–º–∞
    ‚îú‚îÄ‚îÄ adapters/
    ‚îÇ   ‚îú‚îÄ‚îÄ web/     # –í–µ–±-—ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å (–Ω–æ–≤–∏–π)
    ‚îÇ   ‚îú‚îÄ‚îÄ lcd/     # LCD –¥–∏—Å–ø–ª–µ–π
    ‚îÇ   ‚îî‚îÄ‚îÄ mqtt/    # MQTT
    ‚îú‚îÄ‚îÄ ui_filter.cpp     # –§—ñ–ª—å—Ç—Ä–∞—Ü—ñ—è
    ‚îî‚îÄ‚îÄ lazy_loader.cpp   # –û–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—è RAM
```

## ‚úÖ –ü–µ—Ä–µ–≤–∞–≥–∏
- –û–¥–∏–Ω UI –∑–∞–º—ñ—Å—Ç—å –¥–≤–æ—Ö = -50% –∫–æ–¥—É
- Lazy loading = -40% RAM
- –ê–¥–∞–ø—Ç–∏–≤–Ω—ñ—Å—Ç—å –∑ –∫–æ—Ä–æ–±–∫–∏
- –õ–µ–≥—à–µ –¥–æ–¥–∞–≤–∞—Ç–∏ –Ω–æ–≤—ñ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∏

## ‚ö†Ô∏è –©–æ –º–æ–∂–µ –ø—ñ—Ç–∏ –Ω–µ —Ç–∞–∫
- –í–µ–±-—ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å –º–æ–∂–µ –ø–æ—Ç—Ä–µ–±—É–≤–∞—Ç–∏ –¥–æ–¥–∞—Ç–∫–æ–≤–æ—ó –∞–¥–∞–ø—Ç–∞—Ü—ñ—ó
- –ú–æ–∂–ª–∏–≤—ñ –ø–æ–º–∏–ª–∫–∏ –∫–æ–º–ø—ñ–ª—è—Ü—ñ—ó (–ª–µ–≥–∫–æ –≤–∏–ø—Ä–∞–≤–∏—Ç–∏)

## üí° –ü—ñ–¥–∫–∞–∑–∫–∞
–Ø–∫—â–æ —â–æ—Å—å –ø—ñ—à–ª–æ –Ω–µ —Ç–∞–∫ - backup –∑–±–µ—Ä—ñ–≥–∞—î—Ç—å—Å—è –≤ `_archive_ui/`

---
**–ì–æ—Ç–æ–≤–∏–π –∑–∞–ø—É—Å—Ç–∏—Ç–∏ –º—ñ–≥—Ä–∞—Ü—ñ—é?** –ü—Ä–æ—Å—Ç–æ –≤–∏–∫–æ–Ω–∞–π—Ç–µ —Å–∫—Ä–∏–ø—Ç!
