# –ê–Ω–∞–ª—ñ–∑ –¥—É–±–ª—é–≤–∞–Ω–Ω—è —Ç–∞ –∑–∞—Å—Ç–∞—Ä—ñ–ª–æ–≥–æ –∫–æ–¥—É –≤ UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞—Ö

## üîç –í–∏—è–≤–ª–µ–Ω—ñ –¥—É–±–ª—é–≤–∞–Ω–Ω—è

### 1. –ë–∞–∑–æ–≤—ñ –∫–ª–∞—Å–∏ —Ç–∞ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∏

| –§–∞–π–ª –≤ `ui/` | –§–∞–π–ª –≤ `adaptive_ui/` | –î—É–±–ª—é–≤–∞–Ω–Ω—è | –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—è |
|--------------|----------------------|------------|--------------|
| `ui_adapter_base.h` | `ui_component_base.h` | –ë–∞–∑–æ–≤—ñ –∫–æ–Ω—Ü–µ–ø—Ü—ñ—ó UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ñ–≤ | –û–±'—î–¥–Ω–∞—Ç–∏ –≤ —î–¥–∏–Ω–∏–π –±–∞–∑–æ–≤–∏–π –∫–ª–∞—Å |
| `UIControlType` enum | `ComponentType` enum | –¢–∏–ø–∏ UI –∫–æ–Ω—Ç—Ä–æ–ª—ñ–≤ | –í–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ —î–¥–∏–Ω–∏–π enum |
| - | `AccessLevel` enum | –†—ñ–≤–Ω—ñ –¥–æ—Å—Ç—É–ø—É | –ü–µ—Ä–µ–Ω–µ—Å—Ç–∏ –≤ core |

### 2. –§—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω—ñ—Å—Ç—å —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥—É

**ui/ui_adapter_base.h**:
```cpp
enum class UIControlType {
    VALUE, GAUGE, NUMBER, SELECT, 
    SWITCH, BUTTON, SLIDER, TEXT, 
    LIST, CHART
};
```

**adaptive_ui/ui_component_base.h**:
```cpp
enum class ComponentType {
    TEXT, NUMBER, TOGGLE, BUTTON,
    SLIDER, DROPDOWN, CHART, LIST,
    COMPOSITE
};
```

**–í–∏—Å–Ω–æ–≤–æ–∫**: 90% –ø–µ—Ä–µ–∫—Ä–∏—Ç—Ç—è, —Ä—ñ–∑–Ω—ñ –Ω–∞–∑–≤–∏ –¥–ª—è –æ–¥–Ω–∞–∫–æ–≤–∏—Ö –∫–æ–Ω—Ü–µ–ø—Ü—ñ–π.

### 3. –ú–æ–¥—É–ª—å–Ω–∞ –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞

- `ui/` –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î `BaseModule` –±–µ–∑–ø–æ—Å–µ—Ä–µ–¥–Ω—å–æ
- `adaptive_ui/` –º–∞—î –≤–ª–∞—Å–Ω—É —Å–∏—Å—Ç–µ–º—É –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ñ–≤
- –û–±–∏–¥–≤—ñ —Å–∏—Å—Ç–µ–º–∏ –Ω–∞–º–∞–≥–∞—é—Ç—å—Å—è –≤–∏—Ä—ñ—à–∏—Ç–∏ –æ–¥–Ω—É –∑–∞–¥–∞—á—É

## üìã –ó–∞—Å—Ç–∞—Ä—ñ–ª–∏–π –∫–æ–¥ –¥–ª—è –≤–∏–¥–∞–ª–µ–Ω–Ω—è

### –í –ø–∞–ø—Ü—ñ `ui/`:

1. **dynamic_menu_builder.h/cpp** 
   - –°—Ç–∞—Ç–∏—á–Ω–∞ –ø–æ–±—É–¥–æ–≤–∞ –º–µ–Ω—é
   - –ó–∞–º—ñ–Ω—é—î—Ç—å—Å—è –∞–¥–∞–ø—Ç–∏–≤–Ω–æ—é —Å–∏—Å—Ç–µ–º–æ—é
   - **–°—Ç–∞—Ç—É—Å**: –í–∏–¥–∞–ª–∏—Ç–∏ –ø—ñ—Å–ª—è –º—ñ–≥—Ä–∞—Ü—ñ—ó LCD —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—É

2. **–ß–∞—Å—Ç–∏–Ω–∏ ui_adapter_base.h**
   - –ú–µ—Ç–æ–¥–∏ `discover_modules()` - –∑–∞–º—ñ–Ω—é—î—Ç—å—Å—è —Ä–µ—î—Å—Ç—Ä–æ–º
   - –°—Ç–∞—Ç–∏—á–Ω—ñ —Å—Ö–µ–º–∏ - –∑–∞–º—ñ–Ω—é—é—Ç—å—Å—è –≥–µ–Ω–µ—Ä–∞—Ü—ñ—î—é
   - **–°—Ç–∞—Ç—É—Å**: –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏—Ç–∏, –∑–±–µ—Ä–µ–≥—Ç–∏ —Ç—ñ–ª—å–∫–∏ –±–∞–∑–æ–≤—É –ª–æ–≥—ñ–∫—É

### –í –ø–∞–ø—Ü—ñ `adaptive_ui/`:

1. **base_driver.h**
   - –î—É–±–ª—é—î —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω—ñ—Å—Ç—å BaseModule
   - **–°—Ç–∞—Ç—É—Å**: –í–∏–¥–∞–ª–∏—Ç–∏, –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ —ñ—Å–Ω—É—é—á–∏–π BaseModule

2. **module_manager_adaptive.h**
   - –ß–∞—Å—Ç–∫–æ–≤–æ –¥—É–±–ª—é—î ModuleManager –∑ core
   - **–°—Ç–∞—Ç—É—Å**: –Ü–Ω—Ç–µ–≥—Ä—É–≤–∞—Ç–∏ —É–Ω—ñ–∫–∞–ª—å–Ω–∏–π —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª –≤ core

## üóëÔ∏è –§–∞–π–ª–∏ –¥–ª—è –∞—Ä—Ö—ñ–≤–∞—Ü—ñ—ó

### –ü–µ—Ä–µ–º—ñ—â–µ–Ω–Ω—è –≤ _archive:
```
components/_archive_ui/
‚îú‚îÄ‚îÄ old_ui/              # –°—Ç–∞—Ä–∞ ui —Å–∏—Å—Ç–µ–º–∞
‚îÇ   ‚îî‚îÄ‚îÄ dynamic_menu/    # –°—Ç–∞—Ç–∏—á–Ω–µ –º–µ–Ω—é
‚îî‚îÄ‚îÄ adaptive_drafts/     # –ß–µ—Ä–Ω–µ—Ç–∫–∏ adaptive_ui
```

## ‚úÖ –ö–æ–¥ –¥–ª—è –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è —Ç–∞ —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—ó

### –ó `ui/`:
1. ‚úÖ `WebUIModule` - —Ä–æ–±–æ—á–∏–π HTTP —Å–µ—Ä–≤–µ—Ä
2. ‚úÖ `ApiDispatcher` - –æ–±—Ä–æ–±–∫–∞ API –∑–∞–ø–∏—Ç—ñ–≤
3. ‚úÖ HTTP/WebSocket –ª–æ–≥—ñ–∫–∞

### –ó `adaptive_ui/`:
1. ‚úÖ `UIFilter` - —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ñ–≤
2. ‚úÖ `LazyComponentLoader` - –æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—è –ø–∞–º'—è—Ç—ñ
3. ‚úÖ LCD/MQTT –∞–¥–∞–ø—Ç–µ—Ä–∏
4. ‚úÖ –°–∏—Å—Ç–µ–º–∞ —É–º–æ–≤ —Ç–∞ —Ä–æ–ª–µ–π

## üîÑ –ü–ª–∞–Ω —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥—É

### –ö—Ä–æ–∫ 1: –°—Ç–≤–æ—Ä–∏—Ç–∏ –±–∞–∑–æ–≤—ñ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∏
```cpp
// unified_ui/core/interfaces.h
namespace ModESP::UI {
    // –Ñ–¥–∏–Ω–∏–π enum –¥–ª—è —Ç–∏–ø—ñ–≤ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ñ–≤
    enum class ComponentType {
        VALUE,      // –í—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è –∑–Ω–∞—á–µ–Ω–Ω—è
        INPUT,      // –í–≤–µ–¥–µ–Ω–Ω—è (number, text)
        TOGGLE,     // –ü–µ—Ä–µ–º–∏–∫–∞—á (bool)
        BUTTON,     // –ö–Ω–æ–ø–∫–∞ –¥—ñ—ó
        SLIDER,     // –ü–æ–≤–∑—É–Ω–æ–∫
        SELECT,     // –í–∏–±—ñ—Ä –∑—ñ —Å–ø–∏—Å–∫—É
        CHART,      // –ì—Ä–∞—Ñ—ñ–∫
        LIST,       // –°–ø–∏—Å–æ–∫
        COMPOSITE   // –ö–æ–º–ø–æ–∑–∏—Ç–Ω–∏–π
    };
    
    // –ë–∞–∑–æ–≤–∏–π —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞
    class IUIComponent {
    public:
        virtual ~IUIComponent() = default;
        virtual const char* getId() const = 0;
        virtual ComponentType getType() const = 0;
        virtual bool isVisible(const Config& cfg, UserRole role) = 0;
        virtual size_t getEstimatedSize() const = 0;
    };
}
```

### –ö—Ä–æ–∫ 2: –ú—ñ–≥—Ä–∞—Ü—ñ—è –∞–¥–∞–ø—Ç–µ—Ä—ñ–≤
```cpp
// unified_ui/adapters/base_adapter.h
class BaseUIAdapter : public BaseModule {
protected:
    UIComponentRegistry* registry;
    UIFilter* filter;
    LazyComponentLoader* loader;
    
public:
    // –°–ø—ñ–ª—å–Ω–∞ –ª–æ–≥—ñ–∫–∞ –¥–ª—è –≤—Å—ñ—Ö –∞–¥–∞–ø—Ç–µ—Ä—ñ–≤
    virtual void updateVisibleComponents();
    virtual void handleConfigChange(const Config& cfg);
    virtual void handleRoleChange(UserRole role);
};
```

### –ö—Ä–æ–∫ 3: –û–±'—î–¥–Ω–∞–Ω–Ω—è Web —Ç–∞ Adaptive –ª–æ–≥—ñ–∫–∏
```cpp
// unified_ui/adapters/web/web_ui_adapter.h
class WebUIAdapter : public BaseUIAdapter {
    // –õ–æ–≥—ñ–∫–∞ –∑ WebUIModule
    httpd_handle_t server;
    ApiDispatcher* api_dispatcher;
    
    // –ù–æ–≤–∞ –∞–¥–∞–ø—Ç–∏–≤–Ω–∞ –ª–æ–≥—ñ–∫–∞
    void renderAdaptiveUI(httpd_req_t* req);
    void handleDynamicComponent(const std::string& id);
};
```

## üìä –ú–µ—Ç—Ä–∏–∫–∏ –æ—á—ñ–∫—É–≤–∞–Ω–æ–≥–æ –ø–æ–∫—Ä–∞—â–µ–Ω–Ω—è

| –ú–µ—Ç—Ä–∏–∫–∞ | –ó–∞—Ä–∞–∑ | –ü—ñ—Å–ª—è | –ü–æ–∫—Ä–∞—â–µ–Ω–Ω—è |
|---------|-------|-------|------------|
| –ö—ñ–ª—å–∫—ñ—Å—Ç—å —Ñ–∞–π–ª—ñ–≤ | 15 | 8 | -47% |
| –†—è–¥–∫—ñ–≤ –∫–æ–¥—É | ~2500 | ~1500 | -40% |
| –î—É–±–ª—é–≤–∞–Ω–Ω—è | 35% | <5% | -85% |
| RAM (runtime) | 45KB | 25KB | -44% |
| –°–∫–ª–∞–¥–Ω—ñ—Å—Ç—å | –í–∏—Å–æ–∫–∞ | –°–µ—Ä–µ–¥–Ω—è | ‚¨áÔ∏è |

## üö¶ –ü—Ä—ñ–æ—Ä–∏—Ç–µ—Ç–∏ –≤–∏–¥–∞–ª–µ–Ω–Ω—è

### –ù–µ–≥–∞–π–Ω–æ (–Ω–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è):
- [ ] `base_driver.h` 
- [ ] –¢–µ—Å—Ç–æ–≤—ñ/—á–µ—Ä–Ω–µ—Ç–∫–æ–≤—ñ —Ñ–∞–π–ª–∏

### –ü—ñ—Å–ª—è –º—ñ–≥—Ä–∞—Ü—ñ—ó —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—É:
- [ ] `dynamic_menu_builder.*`
- [ ] `module_manager_adaptive.h`
- [ ] –°—Ç–∞—Ä—ñ enum –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è

### –ü—ñ—Å–ª—è –ø–æ–≤–Ω–æ–≥–æ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è:
- [ ] –í—Å—è –ø–∞–ø–∫–∞ `components/ui`
- [ ] –í—Å—è –ø–∞–ø–∫–∞ `components/adaptive_ui`

## ‚ö° Quick wins

1. **–û–±'—î–¥–Ω–∞—Ç–∏ enum'–∏** - 30 —Ö–≤–∏–ª–∏–Ω, –≤–∏–¥–∞–ª–∏—Ç—å 50+ —Ä—è–¥–∫—ñ–≤
2. **–í–∏–¥–∞–ª–∏—Ç–∏ base_driver.h** - 10 —Ö–≤–∏–ª–∏–Ω, -150 —Ä—è–¥–∫—ñ–≤
3. **–ö–æ–Ω—Å–æ–ª—ñ–¥—É–≤–∞—Ç–∏ CMakeLists.txt** - 20 —Ö–≤–∏–ª–∏–Ω, —Å–ø—Ä–æ—Å—Ç–∏—Ç—å –∑–±—ñ—Ä–∫—É
