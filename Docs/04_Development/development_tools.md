# üõ†Ô∏è –Ü–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏ —Ä–æ–∑—Ä–æ–±–∫–∏ ModESP

## üìã –û–≥–ª—è–¥

–ü–∞–ø–∫–∞ `tools/` –º—ñ—Å—Ç–∏—Ç—å —Å–∫—Ä–∏–ø—Ç–∏ —Ç–∞ —É—Ç–∏–ª—ñ—Ç–∏ –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü—ñ—ó —Ä–æ–∑—Ä–æ–±–∫–∏ ModESP, –≤–∫–ª—é—á–∞—é—á–∏ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∏ –∫–æ–¥—É, –≤–∞–ª—ñ–¥–∞—Ç–æ—Ä–∏ —Ç–∞ –¥–æ–ø–æ–º—ñ–∂–Ω—ñ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏.

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ tools/

```
tools/
‚îú‚îÄ‚îÄ adaptive_ui_generator.py    # –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä Adaptive UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ñ–≤
‚îú‚îÄ‚îÄ process_manifests.py        # –û—Å–Ω–æ–≤–Ω–∏–π –æ–±—Ä–æ–±–Ω–∏–∫ –º–∞–Ω—ñ—Ñ–µ—Å—Ç—ñ–≤
‚îú‚îÄ‚îÄ ui_generator.py            # –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä UI (Phase 2)
‚îú‚îÄ‚îÄ event_code_generator.py    # –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –ø–æ–¥—ñ–π
‚îú‚îÄ‚îÄ module_info.py             # –£—Ç–∏–ª—ñ—Ç–∏ –¥–ª—è –º–æ–¥—É–ª—ñ–≤
‚îú‚îÄ‚îÄ test_generator.py          # –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä —Ç–µ—Å—Ç—ñ–≤
‚îú‚îÄ‚îÄ test_phase5.sh            # –¢–µ—Å—Ç–æ–≤–∏–π —Å–∫—Ä–∏–ø—Ç Phase 5
‚îú‚îÄ‚îÄ cleanup_phase2.sh         # –û—á–∏—â–µ–Ω–Ω—è Phase 2
‚îú‚îÄ‚îÄ manifest_schemas/         # JSON —Å—Ö–µ–º–∏ –¥–ª—è –≤–∞–ª—ñ–¥–∞—Ü—ñ—ó
‚îú‚îÄ‚îÄ manifest_tools/           # –î–æ–ø–æ–º—ñ–∂–Ω—ñ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏
‚îî‚îÄ‚îÄ __pycache__/             # Python –∫–µ—à (–≥–µ–Ω–µ—Ä—É—î—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ)
```

## üöÄ –û—Å–Ω–æ–≤–Ω—ñ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏

### 1. **process_manifests.py** - –ì–æ–ª–æ–≤–Ω–∏–π —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç

**–ü—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è**: –û–±—Ä–æ–±–∫–∞ –º–∞–Ω—ñ—Ñ–µ—Å—Ç—ñ–≤ –º–æ–¥—É–ª—ñ–≤ —Ç–∞ –≥–µ–Ω–µ—Ä–∞—Ü—ñ—è –∫–æ–¥—É

**–í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è**:
```bash
# –ë–∞–∑–æ–≤–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è
python tools/process_manifests.py --project-root . --output-dir main/generated

# –ó –¥–µ—Ç–∞–ª—å–Ω–∏–º –ª–æ–≥—É–≤–∞–Ω–Ω—è–º
python tools/process_manifests.py --project-root . --output-dir main/generated --verbose

# –¢—ñ–ª—å–∫–∏ –≤–∞–ª—ñ–¥–∞—Ü—ñ—è –±–µ–∑ –≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó
python tools/process_manifests.py --project-root . --validate-only
```

**–§—É–Ω–∫—Ü—ñ—ó**:
- –°–∫–∞–Ω—É–≤–∞–Ω–Ω—è –ø—Ä–æ–µ–∫—Ç—É –Ω–∞ –º–∞–Ω—ñ—Ñ–µ—Å—Ç–∏
- –í–∞–ª—ñ–¥–∞—Ü—ñ—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∏ –º–∞–Ω—ñ—Ñ–µ—Å—Ç—ñ–≤
- –ì–µ–Ω–µ—Ä–∞—Ü—ñ—è UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ñ–≤
- –°—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ä–µ—î—Å—Ç—Ä—ñ–≤ –º–æ–¥—É–ª—ñ–≤
- –Ü–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è –∑ CMake

### 2. **adaptive_ui_generator.py** - –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä Adaptive UI

**–ü—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è**: –ì–µ–Ω–µ—Ä–∞—Ü—ñ—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ñ–≤ –¥–ª—è Phase 5 Adaptive UI Architecture

**–§—É–Ω–∫—Ü—ñ—ó**:
- –ì–µ–Ω–µ—Ä–∞—Ü—ñ—è UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ñ–≤ –∑ –º–∞–Ω—ñ—Ñ–µ—Å—Ç—ñ–≤
- –°—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ä–µ–Ω–¥–µ—Ä—ñ–≤ –¥–ª—è —Ä—ñ–∑–Ω–∏—Ö –∫–∞–Ω–∞–ª—ñ–≤ (LCD, Web, MQTT)
- –£–º–æ–≤–Ω–∞ —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ñ–≤
- –õ–µ–¥–∞—á–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è (lazy loading)

**–Ü–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è**:
```python
from adaptive_ui_generator import generate_adaptive_ui

# –£ process_manifests.py
generate_adaptive_ui(modules, drivers, output_dir)
```

### 3. **ui_generator.py** - –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä UI (–∑–∞—Å—Ç–∞—Ä—ñ–ª–∏–π)

**–ü—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è**: –ì–µ–Ω–µ—Ä–∞—Ü—ñ—è UI –¥–ª—è –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ—ó –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∏

**–°—Ç–∞—Ç—É—Å**: –ó–∞—Å—Ç–∞—Ä—ñ–ª–∏–π, —Ä–µ–∫–æ–º–µ–Ω–¥—É—î—Ç—å—Å—è –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ Adaptive UI

### 4. **event_code_generator.py** - –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –ø–æ–¥—ñ–π

**–ü—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∞ –≥–µ–Ω–µ—Ä–∞—Ü—ñ—è –∫–æ–¥—É –¥–ª—è —Å–∏—Å—Ç–µ–º–∏ –ø–æ–¥—ñ–π

**–§—É–Ω–∫—Ü—ñ—ó**:
- –ì–µ–Ω–µ—Ä–∞—Ü—ñ—è —Ç–∏–ø—ñ–≤ –ø–æ–¥—ñ–π
- –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –æ–±—Ä–æ–±–Ω–∏–∫—ñ–≤
- –í–∞–ª—ñ–¥–∞—Ü—ñ—è —Å—Ö–µ–º –ø–æ–¥—ñ–π

## üîß –î–æ–ø–æ–º—ñ–∂–Ω—ñ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏

### manifest_schemas/ - JSON —Å—Ö–µ–º–∏

**–ü—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è**: –í–∞–ª—ñ–¥–∞—Ü—ñ—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∏ –º–∞–Ω—ñ—Ñ–µ—Å—Ç—ñ–≤

**–§–∞–π–ª–∏**:
- `module_manifest.schema.json` - –°—Ö–µ–º–∞ –º–∞–Ω—ñ—Ñ–µ—Å—Ç—É –º–æ–¥—É–ª—è
- `driver_manifest.schema.json` - –°—Ö–µ–º–∞ –º–∞–Ω—ñ—Ñ–µ—Å—Ç—É –¥—Ä–∞–π–≤–µ—Ä–∞
- `ui_component.schema.json` - –°—Ö–µ–º–∞ UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞

### manifest_tools/ - –£—Ç–∏–ª—ñ—Ç–∏ –º–∞–Ω—ñ—Ñ–µ—Å—Ç—ñ–≤

**–ü—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è**: –î–æ–ø–æ–º—ñ–∂–Ω—ñ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏ –¥–ª—è —Ä–æ–±–æ—Ç–∏ –∑ –º–∞–Ω—ñ—Ñ–µ—Å—Ç–∞–º–∏

**–Ü–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏**:
- –í–∞–ª—ñ–¥–∞—Ç–æ—Ä–∏
- –ö–æ–Ω–≤–µ—Ä—Ç–µ—Ä–∏
- –ê–Ω–∞–ª—ñ–∑–∞—Ç–æ—Ä–∏ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç–µ–π

## üìù –°–∫—Ä–∏–ø—Ç–∏ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü—ñ—ó

### test_phase5.sh - –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è Adaptive UI

**–ü—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è**: –ê–≤—Ç–æ–º–∞—Ç–∏–∑–æ–≤–∞–Ω–µ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è —Å—É—á–∞—Å–Ω–æ—ó –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∏

```bash
# –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç—ñ–≤
chmod +x tools/test_phase5.sh
./tools/test_phase5.sh
```

**–ü–µ—Ä–µ–≤—ñ—Ä—è—î**:
- –í–∞–ª—ñ–¥–Ω—ñ—Å—Ç—å –º–∞–Ω—ñ—Ñ–µ—Å—Ç—ñ–≤
- –ì–µ–Ω–µ—Ä–∞—Ü—ñ—é –∫–æ–¥—É
- –ö–æ–º–ø—ñ–ª—è—Ü—ñ—é –ø—Ä–æ–µ–∫—Ç—É
- –§—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω—ñ —Ç–µ—Å—Ç–∏

### cleanup_legacy.sh - –û—á–∏—â–µ–Ω–Ω—è –∑–∞—Å—Ç–∞—Ä—ñ–ª–∏—Ö —Ñ–∞–π–ª—ñ–≤

**–ü—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è**: –í–∏–¥–∞–ª–µ–Ω–Ω—è –∑–∞—Å—Ç–∞—Ä—ñ–ª–∏—Ö —Ñ–∞–π–ª—ñ–≤ –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ—Ö –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä

```bash
# –û—á–∏—â–µ–Ω–Ω—è (–£–í–ê–ì–ê: –Ω–µ–∑–≤–æ—Ä–æ—Ç–Ω–æ!)
chmod +x tools/cleanup_phase2.sh
./tools/cleanup_phase2.sh
```

## üîç –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –≤ —Ä–æ–∑—Ä–æ–±—Ü—ñ

### –¢–∏–ø–æ–≤–∏–π workflow:

1. **–°—Ç–≤–æ—Ä–µ–Ω–Ω—è –º–∞–Ω—ñ—Ñ–µ—Å—Ç—É**:
```json
// –£ –≤–∞—à–æ–º—É –º–æ–¥—É–ª—ñ
{
  "module": {
    "name": "MyModule",
    "type": "SENSOR_MANAGER"
  },
  "ui": {
    "adaptive": {
      "components": [...]
    }
  }
}
```

2. **–ì–µ–Ω–µ—Ä–∞—Ü—ñ—è –∫–æ–¥—É**:
```bash
python tools/process_manifests.py --project-root . --output-dir main/generated
```

3. **–ó–±—ñ—Ä–∫–∞ –ø—Ä–æ–µ–∫—Ç—É**:
```bash
idf.py build
```

### –Ü–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è –∑ CMake:

```cmake
# –£ CMakeLists.txt
execute_process(
    COMMAND python ${CMAKE_SOURCE_DIR}/tools/process_manifests.py 
            --project-root ${CMAKE_SOURCE_DIR}
            --output-dir ${CMAKE_BINARY_DIR}/generated
    WORKING_DIRECTORY ${CMAKE_SOURCE_DIR}
)
```

## üêõ –ù–∞–ª–∞–≥–æ–¥–∂–µ–Ω–Ω—è —Ç–∞ –¥—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

### –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –º–∞–Ω—ñ—Ñ–µ—Å—Ç—ñ–≤:
```bash
# –í–∞–ª—ñ–¥–∞—Ü—ñ—è –≤—Å—ñ—Ö –º–∞–Ω—ñ—Ñ–µ—Å—Ç—ñ–≤
python tools/process_manifests.py --validate-only --verbose

# –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –º–∞–Ω—ñ—Ñ–µ—Å—Ç—É
python -c "
import json
from jsonschema import validate
schema = json.load(open('tools/manifest_schemas/module_manifest.schema.json'))
manifest = json.load(open('components/my_module/module_manifest.json'))
validate(manifest, schema)
print('–ú–∞–Ω—ñ—Ñ–µ—Å—Ç –≤–∞–ª—ñ–¥–Ω–∏–π!')
"
```

### –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó:
```bash
# –ì–µ–Ω–µ—Ä–∞—Ü—ñ—è –∑ –¥–µ—Ç–∞–ª—å–Ω–∏–º –ª–æ–≥—É–≤–∞–Ω–Ω—è–º
python tools/process_manifests.py --project-root . --output-dir /tmp/test_gen --verbose

# –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –∑–≥–µ–Ω–µ—Ä–æ–≤–∞–Ω–∏—Ö —Ñ–∞–π–ª—ñ–≤
ls -la /tmp/test_gen/
```

## üìö –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –≤–ª–∞—Å–Ω–∏—Ö —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ñ–≤

### –ë–∞–∑–æ–≤–∏–π —à–∞–±–ª–æ–Ω:

```python
#!/usr/bin/env python3
"""
–ú—ñ–π —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è ModESP
"""

import argparse
import json
import logging
from pathlib import Path

def main():
    parser = argparse.ArgumentParser(description='–ú—ñ–π —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç')
    parser.add_argument('--project-root', required=True, help='–ö–æ—Ä—ñ–Ω—å –ø—Ä–æ–µ–∫—Ç—É')
    parser.add_argument('--verbose', action='store_true', help='–î–µ—Ç–∞–ª—å–Ω–∏–π –≤–∏–≤—ñ–¥')
    
    args = parser.parse_args()
    
    if args.verbose:
        logging.basicConfig(level=logging.DEBUG)
    
    # –í–∞—à–∞ –ª–æ–≥—ñ–∫–∞ —Ç—É—Ç
    
if __name__ == '__main__':
    main()
```

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó:
- –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ argparse –¥–ª—è –∞—Ä–≥—É–º–µ–Ω—Ç—ñ–≤ –∫–æ–º–∞–Ω–¥–Ω–æ–≥–æ —Ä—è–¥–∫–∞
- –î–æ–¥–∞–≤–∞–π—Ç–µ –ª–æ–≥—É–≤–∞–Ω–Ω—è –¥–ª—è –Ω–∞–ª–∞–≥–æ–¥–∂–µ–Ω–Ω—è
- –í–∞–ª—ñ–¥—É–π—Ç–µ –≤—Ö—ñ–¥–Ω—ñ –¥–∞–Ω—ñ
- –°—Ç–≤–æ—Ä—é–π—Ç–µ backup —Ñ–∞–π–ª—ñ–≤ –ø–µ—Ä–µ–¥ –º–æ–¥–∏—Ñ—ñ–∫–∞—Ü—ñ—î—é
- –î–æ–∫—É–º–µ–Ω—Ç—É–π—Ç–µ —Å–≤–æ—ó —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏

## üîó –ü–æ–≤'—è–∑–∞–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è

- [Adaptive UI Architecture](../module_manifest_architecture/ADAPTIVE_UI_ARCHITECTURE.md)
- [–°–∏—Å—Ç–µ–º–∞ –º–∞–Ω—ñ—Ñ–µ—Å—Ç—ñ–≤](../02_Architecture/system_architecture.md)
- [–°—Ç–∞–Ω–¥–∞—Ä—Ç–∏ —Ä–æ–∑—Ä–æ–±–∫–∏](../04_Development/coding_standards.md)
- [–Ü–Ω—Å—Ç—Ä—É–∫—Ü—ñ—ó –∑–±—ñ—Ä–∫–∏](../00_Build_Instructions/BUILD_INSTRUCTIONS.md)

---

*–û–Ω–æ–≤–ª–µ–Ω–æ –¥–ª—è Phase 5 Architecture*
