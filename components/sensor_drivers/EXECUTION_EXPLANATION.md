# Відповідь на питання: Чи виконується код невикористаних драйверів?

## Коротка відповідь: НІ ❌

Код драйвера DS18B20 **НЕ виконується**, якщо в конфігурації вибрано NTC.

## Детальне пояснення

### 📊 Життєвий цикл драйверів:

```
СТАРТ СИСТЕМИ          ІНІЦІАЛІЗАЦІЯ         РОБОТА
     │                      │                   │
     ▼                      ▼                   ▼
┌─────────────┐      ┌──────────────┐    ┌────────────┐
│ Реєстрація  │      │  Створення   │    │ Виконання  │
│ фабричних   │──────│  тільки тих  │────│   тільки   │
│  функцій    │      │ що в config  │    │  активних  │
└─────────────┘      └──────────────┘    └────────────┘
     │                      │                   │
     ▼                      ▼                   ▼
 Всі драйвери         Якщо type="NTC"      driver->read()
 register_driver()     створюється NTC      тільки NTC
```

### 🔍 Приклад роботи:

**sensors.json:**
```json
{
  "sensors": [
    {
      "type": "NTC",        // <-- Тільки NTC!
      "role": "temp1"
    }
  ]
}
```

**Що відбувається:**

1. **При старті** (initialize_builtin_sensor_drivers):
   ```cpp
   // Реєструються ВСІ драйвери (але НЕ створюються!)
   registry.register_driver("NTC", factory_func);
   registry.register_driver("DS18B20", factory_func);  // Тільки функція!
   ```

2. **При ініціалізації SensorModule**:
   ```cpp
   // Створюється ТІЛЬКИ NTC, бо type="NTC"
   if (config.type == "NTC") {
       auto driver = registry.create_driver("NTC");  // DS18B20 НЕ створюється!
   }
   ```

3. **Під час роботи**:
   ```cpp
   // Виконується ТІЛЬКИ код NTC
   for (auto& sensor : sensors_) {  // sensors_ містить тільки NTC
       sensor.driver->read();        // Викликається NTCDriver::read()
   }
   ```

### ⚠️ АЛЕ Є НЮАНС - Flash пам'ять:

```
┌─────────────────────────────────────┐
│         Flash Memory (4MB)          │
├─────────────────────────────────────┤
│  Compiled Code (все компілюється):  │
│  • DS18B20 driver    (~15 KB) ⚠️   │
│  • DS18B20_Async     (~18 KB) ⚠️   │
│  • NTC driver        (~10 KB) ✓    │
│  • Driver Registry   (~5 KB)  ✓    │
├─────────────────────────────────────┤
│  Runtime (виконується):             │
│  • NTC driver        ✓             │
│  • DS18B20           ❌             │
└─────────────────────────────────────┘
```

### 🛠️ Рішення для оптимізації Flash:

Використовуйте **Kconfig** для вимкнення непотрібних драйверів:

```bash
idf.py menuconfig
# Component config → Sensor Drivers Configuration
# [ ] Enable DS18B20 driver      <-- Вимкнути
# [x] Enable NTC driver          <-- Залишити
```

**Результат:**
- До: 48 KB (всі драйвери)  
- Після: 15 KB (тільки NTC)
- **Економія: 33 KB Flash!**

### 📈 Підсумок:

| Аспект | DS18B20 при type="NTC" |
|--------|------------------------|
| Код виконується? | ❌ НІ |
| Об'єкт створюється? | ❌ НІ |
| Пам'ять RAM використовується? | ❌ НІ |
| Код компілюється? | ⚠️ ТАК (за замовчуванням) |
| Flash займає? | ⚠️ ТАК (~15 KB) |
| Можна вимкнути? | ✅ ТАК (через Kconfig) |

### 💡 Рекомендація:

Для production прошивки завжди вимикайте непотрібні драйвери через Kconfig - це звільнить Flash пам'ять для вашого коду!
